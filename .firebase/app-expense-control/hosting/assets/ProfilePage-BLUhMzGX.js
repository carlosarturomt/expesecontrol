import{r,U as w,k as S,j as e,S as T,l as U,d as E,a as P,f as q,m as A}from"./index-HS-5SnU9.js";import{u as D}from"./useAuthRequired-BkyOQgQW.js";function M(){const{isLoading:p,isAuthenticated:m}=D("/register","/profile"),{loading:o,userAuth:x,userData:t}=r.useContext(w),[c,h]=r.useState(!o&&(t==null?void 0:t.expenseControl.budget)||0),[i,g]=r.useState(!o&&(t==null?void 0:t.expenseControl.currency)||"MXN"),[n,y]=r.useState(""),[s,d]=r.useState(""),f=S(),b=()=>{U(A).then(()=>{f("/"),console.log("Signed out successfully"),window.location.reload()}).catch(a=>{console.log("error")})},j=async a=>{if(a.preventDefault(),t&&t.expenseControl){const l=E(P,"userData",x.username),C={"expenseControl.budget":c,"expenseControl.currency":i,...n&&s?{[`paymentTypes.${n}`]:s}:{}};try{await q(l,C),console.log("Updated successfully")}catch(k){console.error("Error updating budget, currency, and paymentTypes:",k)}}else console.error("userData or expenseControl is not available")},v=a=>{const l=a.target.value;y(l),l!=="other"&&d("")},u=a=>{d(a.target.value)},N=["card1","card2","card3","card4","card5"].filter(a=>!(t!=null&&t.paymentTypes&&t.paymentTypes[a]));return p||o||!t?e.jsx(T,{bgTheme:!0}):m?e.jsxs("div",{children:[e.jsxs("section",{className:"w-full max-w-screen-sm mt-6 py-3 flex flex-col items-center",children:[e.jsx("p",{className:"text-main-dark/50",children:"Profile"}),e.jsx("h1",{className:"text-4xl font-bold text-main-dark my-2",children:t&&t.contactInf.username}),e.jsx("p",{className:"text-main-primary",children:t&&t.contactInf.email})]}),e.jsxs("section",{className:"w-full max-w-screen-sm py-6",children:[e.jsxs("form",{onSubmit:j,children:[e.jsxs("hgroup",{className:"relative rounded-3xl py-2 px-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"budget",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Presupuesto"}),e.jsxs("div",{className:"flex-center pt-2 py-2",children:["$",e.jsx("input",{name:"gasto",type:"number",placeholder:"$ $",value:c,onChange:a=>h(Number(a.target.value)),className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50",required:!0}),t==null?void 0:t.expenseControl.currency]})]}),e.jsxs("div",{className:"relative rounded-3xl p-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"currency",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Divisa"}),e.jsxs("select",{name:"currency",value:i,onChange:a=>g(a.target.value),className:"w-full bg-transparent outline-none",children:[e.jsx("option",{value:"MXN",children:"MXN"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"})]})]}),e.jsxs("div",{className:"relative rounded-3xl py-2 px-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"paymentTypes",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Tipos de Pago"}),e.jsxs("span",{className:"flex-center pt-2 py-2",children:[e.jsxs("select",{name:"currency",className:"w-1/3 bg-transparent outline-none",value:n,onChange:v,children:[e.jsx("option",{value:"",disabled:!0,children:"Dar de alta"}),N.map(a=>e.jsx("option",{value:a,children:`Tarjeta ${a.charAt(4)}`},a)),e.jsx("option",{value:"other",children:"Otro tipo de pago"})]}),n!==""&&n!=="other"&&e.jsx("input",{name:"gasto",type:"text",placeholder:"Ej: LikeU, AMEX, Débito",value:s,onChange:u,className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50",required:!0}),n==="other"&&e.jsx("input",{name:"gasto",type:"text",placeholder:"Especifica el tipo de pago",value:s,onChange:u,className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50",required:!0})]}),e.jsx("span",{className:"text-main-dark/50",children:"Por defecto ya está habilitado el tipo de pago en efectivo, no es necesario que lo coloques."})]}),e.jsx("button",{type:"submit",className:"border rounded-3xl p-4 font-semibold text-main-dark hover:bg-main-highlight/10",children:"Actualizar"})]}),e.jsx("button",{onClick:b,className:"border rounded-3xl p-4  mt-4 font-semibold text-main-dark hover:bg-main-highlight/10",children:"Cerrar Sesión"})]})]}):null}export{M as default};
