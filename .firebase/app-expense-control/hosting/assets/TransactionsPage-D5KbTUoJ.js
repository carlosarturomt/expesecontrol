import{r as m,U as j,j as s,S as x,c as y,d as N,q as w,w as g,g as D}from"./index-DcxMiyOV.js";import{u as A}from"./useAuthRequired-CZqXxrnD.js";function E(){const{isLoading:h,isAuthenticated:f}=A("/register","/transactions"),{userAuth:d}=m.useContext(j),[n,b]=m.useState({gastos:[],loading:!0,isModalOpen:!1,gasto:"",title:"",remarks:"",type:"",category:"",file:null,date:new Date().toISOString().substring(0,10),isSubmitting:!1,error:""});return m.useEffect(()=>{(async()=>{const t=new Date().getDate(),i=new Date().getFullYear(),r=new Date().getMonth(),k=new Date(i,r-(t<12?1:0),12),p=new Date(i,r+1-(t<12?0:1),11,23,59,59);let e="";if(t<12)switch(r){case 0:e="diciembreEnero";break;case 1:e="eneroFebrero";break;case 2:e="febreroMarzo";break;case 3:e="marzoAbril";break;case 4:e="abrilMayo";break;case 5:e="mayoJunio";break;case 6:e="junioJulio";break;case 7:e="julioAgosto";break;case 8:e="agostoSeptiembre";break;case 9:e="septiembreOctubre";break;case 10:e="octubreNoviembre";break;case 11:e="noviembreDiciembre";break;default:e="desconocido"}else switch(r){case 0:e="eneroFebrero";break;case 1:e="febreroMarzo";break;case 2:e="marzoAbril";break;case 3:e="abrilMayo";break;case 4:e="mayoJunio";break;case 5:e="junioJulio";break;case 6:e="julioAgosto";break;case 7:e="agostoSeptiembre";break;case 8:e="septiembreOctubre";break;case 9:e="octubreNoviembre";break;case 10:e="noviembreDiciembre";break;case 11:e="diciembreEnero";break;default:e="desconocido"}try{const c=y(N,"userPosts",d.username,"gastos",`${i}`,e),l=w(c,g("createdAt",">=",k),g("createdAt","<=",p)),u=(await D(l)).docs.map(o=>({id:o.id,...o.data()}));b(o=>({...o,gastos:u,loading:!1})),console.log(u)}catch(c){console.error("Error al obtener los gastos: ",c),b(l=>({...l,loading:!1,error:"Error al obtener los gastos."}))}})()},[d.username]),h?s.jsx(x,{bgTheme:!0}):f?s.jsxs("div",{children:[s.jsxs("section",{className:"w-full max-w-screen-sm mt-6 py-3 flex flex-col items-center",children:[s.jsx("p",{className:"text-main-dark/50",children:"Transaccione"}),s.jsx("h1",{className:"text-4xl font-bold text-main-dark my-2",children:"$17,505.00"}),s.jsx("p",{className:"text-main-primary",children:"-$7,000.00"})]}),s.jsxs("section",{className:"w-full max-w-screen-sm py-6",children:[s.jsx("h2",{className:"text-main-dark text-lg font-semibold mb-4",children:"Objetivos Financieros"}),s.jsxs("div",{className:"bg-main-dark/5 rounded-3xl p-4",children:[s.jsx("p",{className:"text-main-dark",children:"Ahorra para un viaje"}),s.jsx("div",{className:"bg-blue-500 rounded-full h-2",style:{width:"60%"}}),s.jsx("p",{className:"text-main-primary font-semibold",children:"Progreso: $600.00 / $1,000.00"})]})]}),s.jsxs("section",{className:"w-full max-w-screen-sm py-3 mb-20",children:[s.jsx("h2",{className:"text-main-dark text-lg font-semibold mb-4",children:"Ãšltimos Gastos"}),n.loading?s.jsx(x,{bgTheme:!0}):n.gastos.length>0?s.jsx("ul",{className:"space-y-3",children:n.gastos.sort((a,t)=>t.createdAt-a.createdAt).map(a=>s.jsxs("li",{className:"flex justify-between items-center bg-main-dark/5 rounded-3xl p-4",children:[s.jsx("span",{className:"text-main-dark font-medium",children:a.title||"Gasto desconocido"}),s.jsxs("span",{className:"text-main-primary font-semibold",children:["-",new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(a.gasto)]})]},a.id))}):s.jsx("li",{className:"flex justify-between items-center bg-main-dark/5 rounded-3xl p-4",children:s.jsx("span",{className:"text-main-dark font-medium",children:"No hay gastos registrados"})})]})]}):null}export{E as default};
