import{r as p,j as s,k as b,i as S,l as j,m as g,n as c,d as u,o as y,S as D}from"./index-DcxMiyOV.js";import{u as I}from"./useAuthRequired-CZqXxrnD.js";import{B as v}from"./BackgroundPage-DgfWQkFg.js";import{I as d,S as U}from"./Button-DSE_j-r0.js";const N=()=>{const[t,o]=p.useState({username:"",email:"",password:""}),[e,h]=p.useState({email:"",password:"",username:""}),m=a=>{const{name:n,value:r}=a.target;h({...e,[n]:r})},x=()=>{const a={};return(e.email.length<8||!/\S+@\S+\.\S+/.test(e.email))&&(a.email="Invalid email."),e.password.length<3&&(a.password="Password is too short."),(e.username.length<6||e.username.includes(" "))&&(a.username="Username must be at least 6 characters and not contain spaces."),o(a),a},w=async a=>{const n=c(u,"userData",a);return!(await y(n)).exists()},f=async a=>{a.preventDefault();const n=x();if(Object.keys(n).length>0){console.log(n);return}const r=e.username;if(!await w(r)){o(i=>({...i,username:"Username already in use. Please choose another one."})),console.log("Username already exists:",r);return}try{const l=(await b(S,e.email,e.password)).user;await j(l,{username:e.username}),await g(c(u,`userAuth/${l.uid}`),{uid:l.uid,email:e.email,password:e.password,displayName:"",username:r,registrationDate:new Date().toISOString(),providerId:l.providerData[0].providerId,rol:"user"}),await g(c(u,`userData/${r}`),{basicInf:{firstName:"",lastName:"",secondLastName:"",gender:"",birthDate:"",maritalStatus:"",profileDescription:"",website:"",language:"",socialMediaHandles:{twitter:"",linkedin:"",instagram:"",facebook:""}},contactInf:{phoneNumbers:{personal:""},email:e.email,emailPersonal:"",username:r,password:e.password,address:{region:"",country:"",mexicoState:"",currentCity:"",nearestAirport:""}},uid:l.uid,registrationDate:new Date().toISOString()})}catch(i){console.error("Error creating user:",i),o({general:i.message})}};return s.jsxs("form",{className:"flex-center flex-col p-6 rounded-xl w-10/12 bg-white -mt-60 mb-60",children:[s.jsx("h1",{className:"text-xl font-semibold mb-3 text-main-dark",children:"Registrarse"}),s.jsxs("div",{className:"w-full flex flex-wrap",children:[s.jsx(d,{name:"email",value:e.email,onChange:m,placeholder:"Correo electrónico",type:"email",classIcon:"bg-white/50"}),t.email&&s.jsx("span",{className:"text-sm text-red-600",children:t.email}),s.jsx(d,{name:"password",value:e.password,onChange:m,placeholder:"Contraseña",type:"password",classIcon:"bg-white/50"}),s.jsx(d,{name:"username",value:e.username,onChange:m,placeholder:"Username",type:"text",classIcon:"bg-white/50"}),t.general&&s.jsx("span",{className:"text-sm text-red-600",children:t.general})]}),s.jsx("div",{className:"w-full my-3 flex-center",children:s.jsx(U,{text:"Registrar",onClick:f})})]})},E=()=>{const{isLoading:t,isAuthenticated:o}=I("/register","/");return t?s.jsx(D,{bgTheme:!0}):o?null:s.jsx(v,{children:s.jsx(N,{})})};export{E as default};
