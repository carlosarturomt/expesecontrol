import{r as n,U as G,a as Q,j as e,S as H,p as J,f as C,d as w,h as k,q as V}from"./index-CrhV-qZD.js";import{u as Y}from"./useAuthRequired-DmLmr_bI.js";import{x as T}from"./x_male_female_purple-CymKkZ1r.js";const K="/assets/female_hair_green-Bg6dJP7d.webp",W="/assets/female_rockstar-hIzQy--H.webp",Z="/assets/female_sunglasses_blondie-BxNSQ5Nq.webp",ee="/assets/male_boy-DU9IE-Ih.webp",te="/assets/male_grandpa-CTFiY2Ib.webp",ae="/assets/male_sunglasses-zqt8rhwS.webp",se="/assets/male_tshirt_red-BG33FSda.webp",ne=[K,W,Z,ee,te,ae,se,T];function ie(){var j,N;const{isLoading:_,isAuthenticated:S}=Y("/register","/profile"),{loading:l,userAuth:d,userData:t,userPlans:x}=n.useContext(G),[h,P]=n.useState(!l&&t&&t.expenseControl&&(t==null?void 0:t.expenseControl.budget)||""),[f,A]=n.useState(!l&&t&&t.expenseControl&&(t==null?void 0:t.expenseControl.currency)||"MXN"),[g,U]=n.useState(!l&&t&&t.expenseControl&&(t==null?void 0:t.expenseControl.cutoffDay)||"1"),[o,q]=n.useState(""),[r,y]=n.useState(""),[i,E]=n.useState(""),[p,I]=n.useState(""),[m,F]=n.useState((t==null?void 0:t.profilePhoto)||""),[b,D]=n.useState(null),R=Q(),$=()=>{J(V).then(()=>{R("/"),console.log("Signed out successfully"),window.location.reload()}).catch(a=>{console.log("error")})},B=a=>{const s=a.target.value;q(s),s!=="other"&&y("")},v=a=>{y(a.target.value)},z=async()=>{if(d&&t){const a=C(w,"userData",d.username);try{await k(a,{profilePhoto:b||m}),console.log("Profile photo updated successfully"),setTimeout(()=>location.reload(),1e3)}catch(s){console.error("Error updating profile photo:",s)}}},O=a=>{const s=a.target.files[0];if(s){const c=new FileReader;c.onload=u=>D(u.target.result),c.readAsDataURL(s)}},L=async a=>{if(a.preventDefault(),z(),t&&t.expenseControl){const s=C(w,"userData",d.username),c={"expenseControl.budget":h,"expenseControl.currency":f,"expenseControl.cutoffDay":g,...o&&r?{[`paymentTypes.${o}`]:r}:{},...i&&p?{[`incomeControl.paymentTypes.${i}`]:p}:{}};try{await k(s,c),console.log("Updated successfully"),setTimeout(()=>location.reload(),1e3)}catch(u){console.error("Error updating budget, currency, and paymentTypes:",u)}}else console.error("userData or expenseControl is not available")},M=["card1","card2","card3","card4","card5"].filter(a=>!(t!=null&&t.paymentTypes&&t.paymentTypes[a])),X=["type1","type2","type3","type4","type5"].filter(a=>!(t!=null&&t.paymentTypes&&t.paymentTypes[a]));return _||l||!t?e.jsx(H,{bgTheme:!0}):S?e.jsxs("div",{children:[e.jsxs("section",{className:"w-full max-w-screen-sm mt-6 py-3 flex flex-col items-center",children:[e.jsxs("div",{className:"w-full flex items-center gap-2",children:[e.jsx("img",{src:b||m||T,alt:"Profile",className:"w-20 h-20 rounded-full object-cover border"}),e.jsxs("hgroup",{className:"",children:[e.jsx("h1",{className:"text-2xl font-bold leading-5 text-main-dark",children:(j=t==null?void 0:t.contactInf)==null?void 0:j.username}),e.jsx("p",{className:"text-sm text-main-primary",children:(N=t==null?void 0:t.contactInf)==null?void 0:N.email})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-main-dark font-semibold mt-4",children:"Actualizar foto de perfil"}),e.jsx("div",{className:"flex gap-4 mt-4 overflow-x-auto",children:ne.map(a=>e.jsx("img",{src:a,alt:"Predefined Avatar",className:`w-16 h-16 rounded-full cursor-pointer border ${m===a?"border-main-primary":"border-gray-300"}`,onClick:()=>F(a)},a))}),x&&x.plan=="enterprise"&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"upload-avatar",className:"block text-main-dark cursor-pointer font-medium",children:"Subir foto personalizada"}),e.jsx("input",{type:"file",id:"upload-avatar",accept:"image/*",className:"mt-2",onChange:O})]})]})]}),e.jsxs("section",{className:"w-full max-w-screen-sm py-6",children:[e.jsxs("form",{onSubmit:L,children:[e.jsxs("div",{className:"relative rounded-3xl py-2 px-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"budget",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Presupuesto"}),e.jsxs("div",{className:"flex-center pt-2 py-2",children:["$",e.jsx("input",{name:"gasto",type:"number",placeholder:"$ $",value:h,onChange:a=>P(Number(a.target.value)),className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50",required:!0}),!l&&t&&t.expenseControl&&(t==null?void 0:t.expenseControl.currency)]})]}),e.jsxs("div",{className:"relative rounded-3xl py-2 px-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"cutoffDay",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Día de corte"}),e.jsx("div",{className:"flex-center pt-2 py-2",children:e.jsx("input",{name:"cutoffDay",type:"number",placeholder:"Define el día de corte. Ej: 1",value:g,onChange:a=>U(a.target.value),className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50",required:!0})})]}),e.jsxs("div",{className:"relative rounded-3xl p-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"currency",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Divisa"}),e.jsxs("select",{name:"currency",value:f,onChange:a=>A(a.target.value),className:"w-full bg-transparent outline-none",children:[e.jsx("option",{value:"MXN",children:"MXN"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"})]})]}),e.jsxs("div",{className:"relative rounded-3xl py-2 px-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"paymentTypes",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Tipos de Pago (Control de Gastos)"}),e.jsxs("span",{className:"flex-center pt-2 py-2",children:[e.jsxs("select",{name:"currency",className:"w-1/3 bg-transparent outline-none",value:o,onChange:B,children:[e.jsx("option",{value:"",disabled:!0,children:"Dar de alta"}),M.map(a=>e.jsx("option",{value:a,children:`Tarjeta ${a.charAt(4)}`},a)),e.jsx("option",{value:"other",children:"Otro tipo de pago"})]}),o!==""&&o!=="other"&&e.jsx("input",{name:"gasto",type:"text",placeholder:"Ej: LikeU, AMEX, Débito",value:r,onChange:v,className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50"}),o==="other"&&e.jsx("input",{name:"gasto",type:"text",placeholder:"Especifica el tipo de pago",value:r,onChange:v,className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50",required:!0})]}),e.jsx("span",{className:"text-main-dark/50",children:"Por defecto ya está habilitado el tipo de pago en efectivo, no es necesario que lo coloques."})]}),e.jsxs("div",{className:"relative rounded-3xl py-2 px-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"incomeTypes",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Tipos de Ingreso"}),e.jsxs("span",{className:"flex-center pt-2 py-2",children:[e.jsxs("select",{name:"incomeTypes",className:"w-1/3 bg-transparent outline-none",value:i,onChange:a=>E(a.target.value),children:[e.jsx("option",{value:"",disabled:!0,children:"Dar de alta"}),X.map(a=>e.jsx("option",{value:a,children:`Tipo de ingreso ${a.charAt(4)}`},a)),e.jsx("option",{value:"other",children:"Otro tipo de ingreso"})]}),i&&e.jsx("input",{name:"incomeCategory",type:"text",placeholder:"Ej: Transferencia, Cheque",value:p,onChange:a=>I(a.target.value),className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50",required:!0})]}),e.jsx("span",{className:"text-main-dark/50",children:"Por defecto ya está habilitado el tipo de ingreso en efectivo, no es necesario que lo coloques."})]}),e.jsx("button",{type:"submit",className:"border rounded-3xl p-4 font-semibold text-main-dark hover:bg-main-highlight/10",children:"Actualizar"})]}),e.jsx("button",{onClick:$,className:"border rounded-3xl p-4 mt-4 mb-12 font-semibold text-main-dark hover:bg-main-highlight/10",children:"Cerrar Sesión"})]})]}):null}export{ie as default};
