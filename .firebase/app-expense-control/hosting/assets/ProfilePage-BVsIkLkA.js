import{r,U as T,k as D,j as e,S as E,l as U,d as q,a as P,f as A,m as R}from"./index-MxSIZaoY.js";import{u as $}from"./useAuthRequired-Bxs4b8Zj.js";function X(){const{isLoading:m,isAuthenticated:x}=$("/register","/profile"),{loading:l,userAuth:h,userData:t}=r.useContext(T),[c,g]=r.useState(!l&&(t==null?void 0:t.expenseControl.budget)||0),[i,f]=r.useState(!l&&(t==null?void 0:t.expenseControl.currency)||"MXN"),[d,y]=r.useState(!l&&(t==null?void 0:t.expenseControl.cutoffDay)||"1"),[n,b]=r.useState(""),[s,u]=r.useState(""),j=D(),v=()=>{U(R).then(()=>{j("/"),console.log("Signed out successfully"),window.location.reload()}).catch(a=>{console.log("error")})},N=async a=>{if(a.preventDefault(),t&&t.expenseControl){const o=q(P,"userData",h.username),w={"expenseControl.budget":c,"expenseControl.currency":i,"expenseControl.cutoffDay":d,...n&&s?{[`paymentTypes.${n}`]:s}:{}};try{await A(o,w),console.log("Updated successfully")}catch(S){console.error("Error updating budget, currency, and paymentTypes:",S)}}else console.error("userData or expenseControl is not available")},C=a=>{const o=a.target.value;b(o),o!=="other"&&u("")},p=a=>{u(a.target.value)},k=["card1","card2","card3","card4","card5"].filter(a=>!(t!=null&&t.paymentTypes&&t.paymentTypes[a]));return m||l||!t?e.jsx(E,{bgTheme:!0}):x?e.jsxs("div",{children:[e.jsxs("section",{className:"w-full max-w-screen-sm mt-6 py-3 flex flex-col items-center",children:[e.jsx("p",{className:"text-main-dark/50",children:"Profile"}),e.jsx("h1",{className:"text-4xl font-bold text-main-dark my-2",children:t&&t.contactInf.username}),e.jsx("p",{className:"text-main-primary",children:t&&t.contactInf.email})]}),e.jsxs("section",{className:"w-full max-w-screen-sm py-6",children:[e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{className:"relative rounded-3xl py-2 px-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"budget",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Presupuesto"}),e.jsxs("div",{className:"flex-center pt-2 py-2",children:["$",e.jsx("input",{name:"gasto",type:"number",placeholder:"$ $",value:c,onChange:a=>g(Number(a.target.value)),className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50",required:!0}),t==null?void 0:t.expenseControl.currency]})]}),e.jsxs("div",{className:"relative rounded-3xl py-2 px-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"cutoffDay",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Día de corte"}),e.jsx("div",{className:"flex-center pt-2 py-2",children:e.jsx("input",{name:"cutoffDay",type:"number",placeholder:"Define el día de corte. Ej: 1",value:d,onChange:a=>y(a.target.value),className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50",required:!0})})]}),e.jsxs("div",{className:"relative rounded-3xl p-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"currency",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Divisa"}),e.jsxs("select",{name:"currency",value:i,onChange:a=>f(a.target.value),className:"w-full bg-transparent outline-none",children:[e.jsx("option",{value:"MXN",children:"MXN"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"})]})]}),e.jsxs("div",{className:"relative rounded-3xl py-2 px-4 mb-4 bg-main-dark/5",children:[e.jsx("label",{htmlFor:"paymentTypes",className:"absolute -top-2 text-sm font-medium rounded-full px-1 text-gray-700/50",children:"Tipos de Pago"}),e.jsxs("span",{className:"flex-center pt-2 py-2",children:[e.jsxs("select",{name:"currency",className:"w-1/3 bg-transparent outline-none",value:n,onChange:C,children:[e.jsx("option",{value:"",disabled:!0,children:"Dar de alta"}),k.map(a=>e.jsx("option",{value:a,children:`Tarjeta ${a.charAt(4)}`},a)),e.jsx("option",{value:"other",children:"Otro tipo de pago"})]}),n!==""&&n!=="other"&&e.jsx("input",{name:"gasto",type:"text",placeholder:"Ej: LikeU, AMEX, Débito",value:s,onChange:p,className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50",required:!0}),n==="other"&&e.jsx("input",{name:"gasto",type:"text",placeholder:"Especifica el tipo de pago",value:s,onChange:p,className:"w-full pl-1 bg-transparent outline-none text-main-dark placeholder:text-main-dark/50",required:!0})]}),e.jsx("span",{className:"text-main-dark/50",children:"Por defecto ya está habilitado el tipo de pago en efectivo, no es necesario que lo coloques."})]}),e.jsx("button",{type:"submit",className:"border rounded-3xl p-4 font-semibold text-main-dark hover:bg-main-highlight/10",children:"Actualizar"})]}),e.jsx("button",{onClick:v,className:"border rounded-3xl p-4  mt-4 font-semibold text-main-dark hover:bg-main-highlight/10",children:"Cerrar Sesión"})]})]}):null}export{X as default};
