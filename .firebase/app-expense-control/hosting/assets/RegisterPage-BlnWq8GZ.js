import{r as p,j as a,N as b,o as j,m as S,p as v,q as g,d as c,a as u,g as N,S as y}from"./index-x0uMOy0q.js";import{u as D}from"./useAuthRequired-BapI__VO.js";import{B as I}from"./BackgroundPage-D-cfovC7.js";import{I as d}from"./Input-CXN44gpF.js";import{a as U}from"./Button-PWxjN8HO.js";const C=()=>{const[t,o]=p.useState({username:"",email:"",password:""}),[e,h]=p.useState({email:"",password:"",username:""}),m=s=>{const{name:n,value:r}=s.target;h({...e,[n]:r})},x=()=>{const s={};return(e.email.length<8||!/\S+@\S+\.\S+/.test(e.email))&&(s.email="Invalid email."),e.password.length<3&&(s.password="Password is too short."),(e.username.length<6||e.username.includes(" "))&&(s.username="Username must be at least 6 characters and not contain spaces."),o(s),s},w=async s=>{const n=c(u,"userData",s);return!(await N(n)).exists()},f=async s=>{s.preventDefault();const n=x();if(Object.keys(n).length>0){console.log(n);return}const r=e.username;if(!await w(r)){o(i=>({...i,username:"Username already in use. Please choose another one."})),console.log("Username already exists:",r);return}try{const l=(await j(S,e.email,e.password)).user;await v(l,{username:e.username}),await g(c(u,`userAuth/${l.uid}`),{uid:l.uid,email:e.email,password:e.password,displayName:"",username:r,registrationDate:new Date().toISOString(),providerId:l.providerData[0].providerId,rol:"user"}),await g(c(u,`userData/${r}`),{basicInf:{firstName:"",lastName:"",secondLastName:"",gender:"",birthDate:"",maritalStatus:"",profileDescription:"",website:"",language:"",socialMediaHandles:{twitter:"",linkedin:"",instagram:"",facebook:""}},contactInf:{phoneNumbers:{personal:""},email:e.email,emailPersonal:"",username:r,password:e.password,address:{region:"",country:"",mexicoState:"",currentCity:"",nearestAirport:""}},uid:l.uid,registrationDate:new Date().toISOString()})}catch(i){console.error("Error creating user:",i),o({general:i.message})}};return a.jsxs("form",{className:"flex-center flex-col p-6 rounded-xl w-10/12 bg-white -mt-60 mb-60",children:[a.jsx("h1",{className:"text-xl font-semibold mb-3 text-main-dark",children:"Registrarse"}),a.jsxs("div",{className:"w-full flex flex-wrap",children:[a.jsx(d,{name:"email",value:e.email,onChange:m,placeholder:"Correo electrónico",type:"email",classIcon:"bg-white/50"}),t.email&&a.jsx("span",{className:"text-sm text-red-600",children:t.email}),a.jsx(d,{name:"password",value:e.password,onChange:m,placeholder:"Contraseña",type:"password",classIcon:"bg-white/50"}),a.jsx(d,{name:"username",value:e.username,onChange:m,placeholder:"Username",type:"text",classIcon:"bg-white/50"}),t.general&&a.jsx("span",{className:"text-sm text-red-600",children:t.general})]}),a.jsx("div",{className:"w-full my-3 flex-center",children:a.jsx(U,{text:"Registrar",onClick:f})}),a.jsx(b,{to:"/login",className:"text-sm text-main-dark hover:underline",children:"Tengo una cuenta"})]})},B=()=>{const{isLoading:t,isAuthenticated:o}=D("/register","/");return t?a.jsx(y,{bgTheme:!0}):o?null:a.jsx(I,{children:a.jsx(C,{})})};export{B as default};
